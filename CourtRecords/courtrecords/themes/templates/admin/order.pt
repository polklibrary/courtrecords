<metal:page
    xmlns:tal="http://xml.zope.org/namespaces/tal"
    xmlns:metal="http://xml.zope.org/namespaces/metal"
    use-macro="load: master.pt">
    
        
    <tal:block metal:fill-slot="header">
        - Order
    </tal:block>
    
    
    <tal:block metal:fill-slot="css">
    </tal:block>
    
    <tal:block metal:fill-slot="js">
        <script>

            $(document).ready(function(){
                var datatable = $("#customer-order-table").dataTable({
                    'processing': false,
                    'serverSide': false,
                    'searching': false,
                    'lengthChange': false,
                    'pageLength': 10,
                    'paging': true,
                    'order': [[ 0, 'asc' ]]
                }); 
                
            });
        </script>
    </tal:block>
    
    <tal:block metal:fill-slot="header">
        - Invoices
    </tal:block>
    
    <tal:block metal:fill-slot="content">
    
        <form method="post">
        
            <h2>Order Information</h2>
            <div id="order-information" class="row">
                <label for="invoice-status">Status</label> <br />
                <select id="invoice-status" name="invoice.status">
                    <option tal:repeat="status statuses" value="${status.id}" tal:attributes="selected python:status.id==invoice.status">${status.status}</option>
                </select>
                &nbsp;
                &nbsp;
                <input id="invoice-status-emailer" type="checkbox" name="invoice.status.emailer"/><label for="invoice-status-emailer" class="fn"> Email customer status update?</label>
            
                <br />
                <br />
                
                <label for="invoice-link">Invoice Link</label> <br />
                <input id="invoice-link" type="text" readonly="true" value="${request.application_url}/invoice/${invoice.hash}" />

                <br />
                <br />
                
                <input id="invoice-agreed" type="checkbox" disabled="true" checked="${invoice.agreement_accepted}" />
                <label for="invoice-agreed">Accepted Agreement</label> 
                
                <br />
                <br />
                <input id="invoice-digital" type="checkbox" name="invoice.deliver_digitally" checked="${invoice.deliver_digitally}" />
                <label for="invoice-digital">Digital Delivery</label>
                
                <br />
                <br />
                <input id="invoice-physical" type="checkbox" name="invoice.deliver_physically"  checked="${invoice.deliver_physically}" />
                <label for="invoice-physical">Physical Delivery</label> 
                
                <br />
                <br />
                
            </div>
            
            <h2>Customer Information</h2>
            <div id="order-customer" class="row">
           
                <label for="invoice-fullname">Name</label> <br />
                <input id="invoice-fullname" type="text" value="${invoice.fullname}" name="invoice.fullname" />
                
                <br />
                <br />
                
                <label for="invoice-email">Email</label> <br />
                <input id="invoice-email" type="text" value="${invoice.email}" name="invoice.email" />
                
                <br />
                <br />
                
                <label for="invoice-phone">Phone</label> <br />
                <input id="invoice-phone" type="text" value="${invoice.phone}" name="invoice.phone" />
                
                <br />
                <br />
                
                <label for="invoice-address">Address</label> <br />
                <input id="invoice-address" type="text" value="${invoice.address}" name="invoice.address" />
                <br />
                <input id="invoice-county_state_zip" type="text" value="${invoice.county_state_zip}" name="invoice.county_state_zip" />
                
                <br />
                <br />
                
            </div>
            
            <h2>Records</h2>
            <div class="row">
                <table id="customer-order-table" class="tablesorter dt-generic-style">
                    <thead>
                        <tr>
                            <th>Case #</th>
                            <th>Entity</th>
                            <th>County</th>
                            <th>Year</th>
                            <th>Container</th>
                            <th>Container #</th>
                            <th>Subset</th>
                            <th>Case Type</th>
                            <th>Price</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="" tal:repeat="record records" onclick="window.open('${request.application_url}/manage/records/${record.case.Cases.id}')">
                            <td>
                                ${record.case.Cases.case_number}
                            </td>
                            <td>
                                ${record.case.Entities.firstname} ${record.case.Entities.middlename} ${record.case.Entities.entity} 
                            </td>
                            <td>${record.case.Counties.county}</td>
                            <td>
                                <tal:block condition="record.case.Cases.year">
                                    ${record.case.Cases.year} 
                                </tal:block>
                                <tal:block condition="not: record.case.Cases.year">
                                   --
                                </tal:block>
                            </td>
                            <td>
                                <tal:block condition="record.case.Containers.container">
                                    ${record.case.Containers.container}
                                </tal:block>
                                <tal:block condition="not: record.case.Containers.container">
                                   --
                                </tal:block>
                            </td>
                            <td>
                                <tal:block condition="python: record.case.Cases.container_number and record.case.Cases.container_number != '0'">
                                    ${record.case.Cases.container_number}
                                </tal:block>
                                <tal:block condition="python: not record.case.Cases.container_number or record.case.Cases.container_number == '0'">
                                   --
                                </tal:block>
                            </td>
                            <td>
                                <tal:block condition="record.case.Cases.subset and record.case.Cases.subset != '0'">
                                    ${record.case.Cases.subset}
                                </tal:block>
                                <tal:block condition="not: record.case.Cases.subset or record.case.Cases.subset == '0'">
                                   --
                                </tal:block>
                            </td>
                            <td>${record.case.ActionTypes.actiontype}</td>
                            <td>${record.price}</td>
                        </tr>
                    </tbody>
                </table>
                <div id="order-price">Total Price: ${invoice.total_price}</div>
            </div>
           
            
            <div class="buttons">
                <input class="button" type="submit" value="Save" name="invoice.submit" />
                <a class="button red" href="${request.application_url}/manage/orders">Cancel</a>
            </div>
            
        </form>
        
    </tal:block>
     
</metal:page>